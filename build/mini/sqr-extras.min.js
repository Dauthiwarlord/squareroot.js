SQR.TextureGenerator={noise:function(t,n){t=t||512,n=n||t;var e=document.createElement("canvas");e.width=t,e.height=n;for(var o=e.getContext("2d"),a=o.createImageData(t,n),r=a.data,d=0,i=r.length;i>d;d+=4)r[d+0]=255*Math.random()|0,r[d+1]=255*Math.random()|0,r[d+2]=255*Math.random()|0,r[d+3]=255;return o.putImageData(a,0,0),e}},SQR.Trackball=function(){var t={};t.rotation=new SQR.Quaternion;var n=function(t,n,e,o){e=e||.5,o=o||new SQR.V3;var a=t/e,r=n/e,d=a*a+r*r;return d>=1?o.set(a,r,0):o.set(a,r,Math.sqrt(1-d)),o.norm(),o},e=0,o=0,a=!1,r=new SQR.V3,d=new SQR.V3,i=new SQR.Quaternion,u=window.innerWidth/window.innerHeight,c=function(t){t="ontouchstart"in document?t.targetTouches[0]:t,e=(t.pageX/window.innerWidth*2-1)*u,o=-1*(t.pageY/window.innerHeight*2-1)},m=function(t){a=!0,c(t),n(e,o,1,r)},s=function(u){if(a){c(u),n(e,o,1,d);var m=SQR.V3.dot(r,d);r.cross(d,r),i.set(r.x,r.y,r.z,m),t.rotation.mul(i),r.copyFrom(d)}},h=function(){a=!1};return"ontouchstart"in document?(document.addEventListener("touchstart",m,!1),document.addEventListener("touchmove",s,!1),document.addEventListener("touchend",h,!1)):(document.addEventListener("mousedown",m,!1),document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",h,!1)),t};