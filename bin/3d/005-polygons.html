<!DOCTYPE html>
<html>
<head>
    <title>Polygons | v0.21</title>

    <script type="text/javascript" src="../../lib/requestAnimFrame.js"></script>

<!-- SQRLIB -->
<!-- Auto-generated by tools/demojstags.py. Do not edit this section -->
<script type="text/javascript" src="../../lib/requestAnimFrame.js"></script>
<script type="text/javascript" src="../../src/SQR.js"></script>
<script type="text/javascript" src="../../src/color/Color.js"></script>
<script type="text/javascript" src="../../src/math/Interpolation.js"></script>
<script type="text/javascript" src="../../src/math/Matrix2D.js"></script>
<script type="text/javascript" src="../../src/math/Matrix33.js"></script>
<script type="text/javascript" src="../../src/math/Matrix44.js"></script>
<script type="text/javascript" src="../../src/math/ProjectionMatrix.js"></script>
<script type="text/javascript" src="../../src/math/QuadraticBezier.js"></script>
<script type="text/javascript" src="../../src/math/Quaternion.js"></script>
<script type="text/javascript" src="../../src/math/Spline.js"></script>
<script type="text/javascript" src="../../src/math/Vector2.js"></script>
<script type="text/javascript" src="../../src/math/Vector3.js"></script>
<script type="text/javascript" src="../../src/math/VectorUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/Geometry.js"></script>
<script type="text/javascript" src="../../src/sqr/Squareroot.js"></script>
<script type="text/javascript" src="../../src/sqr/Transform.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Particle2D.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Plane.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Triangle.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/DOMElement2D.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/DOMElement3D.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Particle.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Polygon.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Segment.js"></script>
<script type="text/javascript" src="../../src/sqr/util/CanvasUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/util/DOMUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Stringify.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Time.js"></script>
<!-- SQRLIB -->

    <style type="text/css">

        body {
            overflow: hidden;
        }

        #canvas {
            position: absolute;
            top: 0px;
            left: 0px;
        }

    </style>

    <script type="text/javascript">

        var engine, camera, geometry, renderer;

        var zero = new SQR.V3();

        var temp = new SQR.V3();
        var up = new SQR.V3();
        
        function addPointer(x, y, z) {
            var p1 = new SQR.Transform();
            p1.geometry = geometry;
            p1.renderer = renderer;
            p1.position.set(x, y, z).norm().mul(radius);

            p1.position.copyTo(temp);
            up.set(0,1,0);
            p1.useQuaternion = true;
            p1.rotationQ.lookAt(temp, up);

            return p1;
        }

        function addRing() {
            var mesh = new SQR.Transform();

            mesh.add(addPointer(0, 10, 0));
            mesh.add(addPointer(0, -10, 0));

            mesh.add(addPointer(10, 0, 0));
            mesh.add(addPointer(-10, 0, 0));

            mesh.add(addPointer(10, 10, 0));
            mesh.add(addPointer(10, -10, 0));
            mesh.add(addPointer(-10, 10, 0));
            mesh.add(addPointer(-10, -10, 0));

            mesh.add(addPointer(0, 0, 10));
            mesh.add(addPointer(0, 0, -10));

            mesh.add(addPointer(0, 10, 10));
            mesh.add(addPointer(0, 10, -10));
            mesh.add(addPointer(0, -10, 10));
            mesh.add(addPointer(0, -10, -10));

            mesh.add(addPointer(10, 0, 10));
            mesh.add(addPointer(10, 0, -10));
            mesh.add(addPointer(-10, 0, 10));
            mesh.add(addPointer(-10, 0, -10));
            engine.add(mesh);

            return mesh;
        }

        window.onload = function() {

//            var a = new SQR.V3(0,1,0);
//            var b = new SQR.V3(0,0,-1);
//            var c = new SQR.V3();
//            c.cross(a, b);
//            console.log();

            document.addEventListener('touchmove', function(e) {
                e.preventDefault();
            }, false);

            engine = new SQR.Squareroot(document.getElementById('canvas'), document.getElementById("div-container"));
            engine.setBackground('#000000');
            engine.setSize(window.innerWidth, window.innerHeight);
            engine.setProjection(45);

            camera = new SQR.Transform();
            camera.position.z = 70;
            engine.add(camera);

            geometry = new SQR.Geometry();

            var blue = new SQR.Color(186, 100, 70);
            var red = new SQR.Color(0, 100, 70);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, -1), v(-2, 2, 0), blue);
            geometry.addTriangle(v(2, -2, 0), v(0, 0, -1), v(2, 2, 0), blue);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, -1), v(2, -2, 0), blue);
            geometry.addTriangle(v(-2, 2, 0), v(0, 0, -1), v(2, 2, 0), blue);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, 6), v(-2, 2, 0), blue);
            geometry.addTriangle(v(2, -2, 0), v(0, 0, 6), v(2, 2, 0), blue);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, 6), v(2, -2, 0), blue);
            geometry.addTriangle(v(-2, 2, 0), v(0, 0, 6), v(2, 2, 0), blue);

            renderer = new SQR.Polygon();
            radius = 7;
            m1 = addRing();

            geometry = new SQR.Geometry();

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, -1), v(-2, 2, 0), red);
            geometry.addTriangle(v(2, -2, 0), v(0, 0, -1), v(2, 2, 0), red);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, -1), v(2, -2, 0), red);
            geometry.addTriangle(v(-2, 2, 0), v(0, 0, -1), v(2, 2, 0), red);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, 6), v(-2, 2, 0), red);
            geometry.addTriangle(v(2, -2, 0), v(0, 0, 6), v(2, 2, 0), red);

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, 6), v(2, -2, 0), red);
            geometry.addTriangle(v(-2, 2, 0), v(0, 0, 6), v(2, 2, 0), red);

            radius = 16;
            m2 = addRing();
            
            geometry = new SQR.Geometry();

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, -1), v(-2, 2, 0), 'rgb(0,155,0)');
            geometry.addTriangle(v(2, -2, 0), v(0, 0, -1), v(2, 2, 0), 'rgb(0,255,0)');

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, -1), v(2, -2, 0), 'rgb(0,205,0)');
            geometry.addTriangle(v(-2, 2, 0), v(0, 0, -1), v(2, 2, 0), 'rgb(0,205,0)');

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, 6), v(-2, 2, 0), 'rgb(0,50,0)');
            geometry.addTriangle(v(2, -2, 0), v(0, 0, 6), v(2, 2, 0), 'rgb(0,150,0)');

            geometry.addTriangle(v(-2, -2, 0), v(0, 0, 6), v(2, -2, 0), 'rgb(0,100,0)');
            geometry.addTriangle(v(-2, 2, 0), v(0, 0, 6), v(2, 2, 0), 'rgb(0,100,0)');

            radius = 25;
            //m3 = addRing();

            render();
        }

        function v(x, y, z) {
            return new SQR.V3(x, y, z);
        }

        var th = 0;
        var tempQ = new SQR.Quaternion();

        function render() {
            requestAnimFrame(render);
            if(th++ % 2 == 1) return;

            for(var i = 0; i < m1.numChildren; i++) {
                var p = m1.children[i].position;
                tempQ.fromAngleAxis(0.005, p.x, p.y, p.z);
                m1.children[i].rotationQ.mul(tempQ);
            }

            for(var i = 0; i < m2.numChildren; i++) {
                var p = m2.children[i].position;
                tempQ.fromAngleAxis(-0.003, p.x, p.y, p.z);
                m2.children[i].rotationQ.mul(tempQ);
            }

            m1.rotation.y -= 0.5 * SQR.Time.deltaTime;
            m1.rotation.x -= 0.5 * SQR.Time.deltaTime;

            m2.rotation.y += 0.3 * SQR.Time.deltaTime;
            m2.rotation.x -= 0.5 * SQR.Time.deltaTime;

//            m3.rotation.y -= 0.1 * SQR.Time.deltaTime;
//            m3.rotation.x += 0.1 * SQR.Time.deltaTime;

            engine.render(camera);
        }

    </script>

</head>
<body>
<div id="canvas-container">
    <canvas id="canvas"></canvas>
</div>
<div id="div-container"></div>
</body>
</html>