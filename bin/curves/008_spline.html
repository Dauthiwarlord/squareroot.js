<!DOCTYPE html>
<html>
<head>
    <title>008 Spline | v0.1</title>

    <link rel="stylesheet" href="curves.css">

<!-- SQRLIB -->
<!-- Auto-generated by tools/demojstags.py. Do not edit this section -->
<script type="text/javascript" src="../../lib/requestAnimFrame.js"></script>
<script type="text/javascript" src="../../src/SQR.js"></script>
<script type="text/javascript" src="../../src/color/Color.js"></script>
<script type="text/javascript" src="../../src/math/Interpolation.js"></script>
<script type="text/javascript" src="../../src/math/Mathx.js"></script>
<script type="text/javascript" src="../../src/math/Matrix2D.js"></script>
<script type="text/javascript" src="../../src/math/Matrix33.js"></script>
<script type="text/javascript" src="../../src/math/Matrix44.js"></script>
<script type="text/javascript" src="../../src/math/Noise.js"></script>
<script type="text/javascript" src="../../src/math/PerlinNoise.js"></script>
<script type="text/javascript" src="../../src/math/ProjectionMatrix.js"></script>
<script type="text/javascript" src="../../src/math/QuadraticBezier.js"></script>
<script type="text/javascript" src="../../src/math/Quaternion.js"></script>
<script type="text/javascript" src="../../src/math/Spline.js"></script>
<script type="text/javascript" src="../../src/math/Spring.js"></script>
<script type="text/javascript" src="../../src/math/Vector2.js"></script>
<script type="text/javascript" src="../../src/math/Vector3.js"></script>
<script type="text/javascript" src="../../src/math/VectorUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/Geometry.js"></script>
<script type="text/javascript" src="../../src/sqr/Squareroot.js"></script>
<script type="text/javascript" src="../../src/sqr/Transform.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Particle2D.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Plane.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Quad.js"></script>
<script type="text/javascript" src="../../src/sqr/objects/Triangle.js"></script>
<script type="text/javascript" src="../../src/sqr/physics/CSSCollider.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/DOMElement2D.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/DOMElement3D.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Particle.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Polygon.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Segment.js"></script>
<script type="text/javascript" src="../../src/sqr/util/CanvasUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/util/DOMUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Interactor.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Stringify.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Time.js"></script>
<!-- SQRLIB -->

    <script type="text/javascript">

        var ctx;

        function drawControlPoints(c) {
            ctx.globalAlpha = 0.2;
            ctx.strokeStyle = 'rgb(255,0,0)';

            ctx.beginPath();

            ctx.moveTo(c.p0.x, c.p0.y);
            ctx.lineTo(c.c0.x, c.c0.y);
            ctx.lineTo(c.c1.x, c.c1.y);
            ctx.lineTo(c.p1.x, c.p1.y);

            ctx.stroke();
        }

        function drawCurve(c) {
            ctx.globalAlpha = 0.2;
            ctx.strokeStyle = 'rgb(0,0,128)';

            ctx.beginPath();

            for (var i = 0; i <= 100; i += 1) {
                var t = i / 100;
                var cv = c.valueAt(t);
                if (i == 0) ctx.moveTo(cv.x, cv.y);
                else ctx.lineTo(cv.x, cv.y);
            }

            ctx.stroke();
        }

        function drawPointOnCurve(c, freq) {
            ctx.globalAlpha = 1;
            ctx.strokeStyle = 'rgb(0,0,128)';

            for (var i = 0; i <= freq; i += 1) {
                var t = i / freq;
                var cv = c.valueAt(t);
                ctx.beginPath();
                ctx.arc(cv.x, cv.y, 1, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function findMidpoint(a, b) {
            return new SQR.V2().sub(b, a).mul(0.5).addTo(a);
        }

        window.onload = function() {
            ctx = document.getElementById('cnv').getContext('2d');

            var k1 = new SQR.V2(100, 350);
            var k2 = new SQR.V2(400, 300);
            var k3 = new SQR.V2(200, 120);

            var k4 = new SQR.V2(800, 80);
            var k5 = new SQR.V2(600, 300);
            var k6 = new SQR.V2(900, 350);

            var ik = findMidpoint(k3, k4);

            var s1 = new SQR.QuadraticBezier(k1, k2, k3, ik);
            var s2 = new SQR.QuadraticBezier(ik, k4, k5, k6);

            // 1 ############################################
            drawControlPoints(s1);
            drawControlPoints(s2);

            // 2 ############################################
            drawCurve(s1);
            drawCurve(s2);

            // 3 ############################################
            drawPointOnCurve(s1, 25);
            drawPointOnCurve(s2, 25);
        }

    </script>

</head>
<body>

<div id="desc">
    <h1>008 Spline</h1>

    <p>A simple spline using multiple QuadraticBezier curves</p>
</div>


<div id="container">
    <canvas id="cnv" width="1000" height="500"></canvas>
</div>
</body>
</html>