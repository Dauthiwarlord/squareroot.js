<!DOCTYPE html>
<html>
<head>
    <title>013 Bezier curves in 3D | v0.1</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable = no">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <style type="text/css">

        #container, #cnv {
            position: absolute;
            top: 0px;
            left: 0px;

            width: 100%;
            height: 100%;
        }

    </style>


<!-- SQRLIB -->
<!-- Auto-generated by tools/demojstags.py. Do not edit this section -->
<script type="text/javascript" src="../../src/requestAnimFrame.js"></script>
<script type="text/javascript" src="../../src/SQR.js"></script>
<script type="text/javascript" src="../../src/sqr/Squareroot.js"></script>
<script type="text/javascript" src="../../src/sqr/SquarerootGL.js"></script>
<script type="text/javascript" src="../../src/sqr/Transform.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Cube.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Cylinder.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Geometry.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Icosphere.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Mesh.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Plane.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Pyramid.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Quad.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Sprite2D.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Sprite3D.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Triangle.js"></script>
<script type="text/javascript" src="../../src/sqr/geometry/Tube.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Interpolation.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Mathx.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Matrix2D.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Matrix33.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Matrix44.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Noise.js"></script>
<script type="text/javascript" src="../../src/sqr/math/PerlinNoise.js"></script>
<script type="text/javascript" src="../../src/sqr/math/ProjectionMatrix.js"></script>
<script type="text/javascript" src="../../src/sqr/math/QuadraticBezier.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Quaternion.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Spline.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Spring.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Vector2.js"></script>
<script type="text/javascript" src="../../src/sqr/math/Vector3.js"></script>
<script type="text/javascript" src="../../src/sqr/math/VectorUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/physics/CSSCollider.js"></script>
<script type="text/javascript" src="../../src/sqr/physics/Particle.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/DOMElement2D.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/DOMElement3D.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Point.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Polygon.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/Segment.js"></script>
<script type="text/javascript" src="../../src/sqr/renderers/WebGL.js"></script>
<script type="text/javascript" src="../../src/sqr/util/CanvasUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Color.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Cubemap.js"></script>
<script type="text/javascript" src="../../src/sqr/util/DOMUtil.js"></script>
<script type="text/javascript" src="../../src/sqr/util/FrameBuffer.js"></script>
<script type="text/javascript" src="../../src/sqr/util/GL.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Interactor.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Loader.js"></script>
<script type="text/javascript" src="../../src/sqr/util/OBJParser.js"></script>
<script type="text/javascript" src="../../src/sqr/util/PostEffect.js"></script>
<script type="text/javascript" src="../../src/sqr/util/RenderRegion.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Shader.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Stringify.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Texture.js"></script>
<script type="text/javascript" src="../../src/sqr/util/Time.js"></script>
<!-- SQRLIB -->

    <script type="text/javascript">

        var engine, camera, curves;

        var createSegment = function(path, numVertices, geometry) {
            var g = geometry || {};
            g.continous = true;

            g.vertices = g.vertices || [];
            g.tangents = g.tangents || [];

            for(var i = 0; i <= numVertices; i++) {
                var t = i / numVertices;
                g.vertices.push(path.valueAt(t, new SQR.V3()));
                g.tangents.push(path.velocityAt(t, new SQR.V3()));
            } 

            g.vertices.push(g.vertices[0]);
            g.tangents.push(g.tangents[0]);  

            return g;
        }

        function makeCurve(c, color, segments) {
            var curve = new SQR.Transform();
            curve.geometry = createSegment(c, segments || 30);
            curve.geometry.color = color;
            curve.renderer = new SQR.Segment(1);
            return curve;
        }

        window.onload = function() {

            engine = new SQR.Squareroot(document.getElementById('cnv'), container);
            
            engine.setSize(window.innerWidth, window.innerHeight);
            engine.setProjection(60);
            engine.setBackground("#000");

            var curve1 = makeCurve(new SQR.QuadraticBezier(
                    new SQR.V3(-40,  15, -40),
                    new SQR.V3(-10, -20, -10),
                    new SQR.V3( 10,  20,  10),
                    new SQR.V3( 40,   5, -20)),
                    new SQR.Color(0, 100, 50)
            );

            var curve2 = makeCurve(new SQR.QuadraticBezier(
                    new SQR.V3( 10, -40,  -40),
                    new SQR.V3( 20, -20,  10),
                    new SQR.V3(-30,   0, -10),
                    new SQR.V3( -5,   40, 20)),
                    new SQR.Color(100, 50, 50)
            );

            var curve3 = makeCurve(new SQR.QuadraticBezier(
                    new SQR.V3(-10, -25, -20),
                    new SQR.V3( -5,  30, -60),
                    new SQR.V3(  8,  35,  10),
                    new SQR.V3( 12, -15,  20)),
                    new SQR.Color(200, 100, 50)
            );

            var k1 = new SQR.V3(200, 100, 300);
            var k2 = new SQR.V3(200, -100, 0);
            var k3 = new SQR.V3(100, -200, 300);
            var k4 = new SQR.V3(-100, -200, 0);
            var spline1path = new SQR.Spline(k1, k2, k3, k4);

            k1 = new SQR.V3(-200, -100, 00);
            k2 = new SQR.V3(-200, 100, 0);
            spline1path.add(k1, k2);

            k1 = new SQR.V3(-100, 200, 0);
            k2 = new SQR.V3(100, 300, 0);
            spline1path.add(k1, k2);

            spline1path.closePath();

            var spline1 = makeCurve(spline1path, new SQR.Color(0, 50, 100), 120);

            curves = new SQR.Transform();
            curves.add(curve1, curve2, curve3);
            curves.add(spline1);

            camera = new SQR.Transform();
            camera.position.z = 700;

            engine.add(camera, curves);

            render();
        }

        function render() {
            requestAnimFrame(render);
            curves.rotation.y += 0.008;
            // curves.rotation.x += 0.008;
            engine.render(camera);
        }

    </script>

</head>
<body>
<div id="container">
    <canvas id="cnv" width="1000" height="500"></canvas>
</div>

<script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>
</body>
</html>